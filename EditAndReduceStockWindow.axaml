<Window xmlns="https://github.com/avaloniaui"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="clr-namespace:MSM.ViewModels"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        mc:Ignorable="d" d:DesignWidth="480" d:DesignHeight="750"
        x:Class="MSM.EditAndReduceStockWindow"
        x:DataType="d:EditAndReduceStockViewModel"
        Title="상품 정보 수정"
        MinHeight="750"
        Width="480"
        Background="{DynamicResource SemiGrey1Color}"
        WindowStartupLocation="CenterOwner">

    <ScrollViewer VerticalScrollBarVisibility="Auto">
        <StackPanel Margin="24" Spacing="20">
            <!-- Header -->
            <StackPanel Spacing="6">
                <TextBlock Text="상품 정보 수정"
                           FontSize="28"
                           FontWeight="Bold"/>
                <TextBlock Text="상품 정보를 수정하거나 재고를 차감합니다"
                           FontSize="15"
                           Foreground="{DynamicResource SemiGrey6Color}"/>
            </StackPanel>

            <!-- Quick Reduce Section (Highlighted) -->
            <Border Background="{DynamicResource SemiBlue1Color}"
                    CornerRadius="8"
                    Padding="20"
                    BorderBrush="{DynamicResource SemiBlue3Color}"
                    BorderThickness="1">
                <StackPanel Spacing="12">
                    <StackPanel Spacing="6">
                        <TextBlock Text="재고 차감"
                                   FontSize="16"
                                   FontWeight="SemiBold"
                                   Foreground="{DynamicResource SemiBlue7Color}"/>
                        <TextBlock Text="현재 재고에서 수량을 차감합니다"
                                   FontSize="14"
                                   Foreground="{DynamicResource SemiBlue6Color}"/>
                    </StackPanel>

                    <Grid ColumnDefinitions="*,Auto">
                        <StackPanel Grid.Column="0" Spacing="8">
                            <TextBlock Text="차감할 수량" FontSize="15"/>
                            <NumericUpDown Value="{Binding ReductionAmount}"
                                           FormatString="0"
                                           Minimum="1"
                                           Maximum="{Binding Quantity}"
                                           FontSize="14"/>
                        </StackPanel>
                        <Button Grid.Column="1"
                                Content="차감하기"
                                Command="{Binding ReduceAndSaveCommand}"
                                Classes="Primary"
                                Padding="20,12"
                                FontSize="14"
                                VerticalAlignment="Bottom"
                                Margin="12,0,0,0"/>
                    </Grid>
                </StackPanel>
            </Border>

            <!-- Basic Info Section -->
            <Border Background="{DynamicResource SemiGrey0Color}"
                    CornerRadius="8"
                    Padding="20">
                <StackPanel Spacing="16">
                    <TextBlock Text="기본 정보"
                               FontSize="16"
                               FontWeight="SemiBold"
                               Foreground="{DynamicResource SemiGrey8Color}"/>

                    <!-- Product Name -->
                    <StackPanel Spacing="8">
                        <TextBlock Text="상품명" FontSize="15"/>
                        <TextBox Text="{Binding Name}"
                                 Watermark="상품 이름"
                                 FontSize="14"/>
                    </StackPanel>

                    <!-- Product Image -->
                    <StackPanel Spacing="8">
                        <TextBlock Text="상품 이미지" FontSize="15"/>
                        <Border Background="{DynamicResource SemiGrey1Color}"
                                CornerRadius="6"
                                Padding="16"
                                BorderBrush="{DynamicResource SemiGrey3Color}"
                                BorderThickness="1">
                            <Grid ColumnDefinitions="80,*,Auto">
                                <Border Grid.Column="0"
                                        Background="{DynamicResource SemiGrey2Color}"
                                        CornerRadius="4"
                                        Width="64"
                                        Height="64"
                                        ClipToBounds="True">
                                    <Image Source="{Binding ProductImage}"
                                           Stretch="UniformToFill"/>
                                </Border>
                                <TextBlock Grid.Column="1"
                                           Text="{Binding ImagePath, TargetNullValue='이미지를 선택하세요'}"
                                           VerticalAlignment="Center"
                                           Margin="12,0"
                                           FontSize="14"
                                           Foreground="{DynamicResource SemiGrey6Color}"
                                           TextTrimming="CharacterEllipsis"/>
                                <Button Grid.Column="2"
                                        Content="선택"
                                        Command="{Binding BrowseImageCommand}"
                                        VerticalAlignment="Center"
                                        Padding="16,8"
                                        FontSize="14"/>
                            </Grid>
                        </Border>
                    </StackPanel>
                </StackPanel>
            </Border>

            <!-- Quantity Section -->
            <Border Background="{DynamicResource SemiGrey0Color}"
                    CornerRadius="8"
                    Padding="20">
                <StackPanel Spacing="16">
                    <TextBlock Text="수량 설정"
                               FontSize="16"
                               FontWeight="SemiBold"
                               Foreground="{DynamicResource SemiGrey8Color}"/>

                    <Grid ColumnDefinitions="*,16,*">
                        <StackPanel Grid.Column="0" Spacing="8">
                            <TextBlock Text="현재 재고" FontSize="15"/>
                            <NumericUpDown Value="{Binding Quantity, Mode=TwoWay}"
                                           FormatString="0"
                                           Minimum="0"
                                           FontSize="14"/>
                        </StackPanel>
                        <StackPanel Grid.Column="2" Spacing="8">
                            <TextBlock Text="1회 차감량" FontSize="15"/>
                            <NumericUpDown Value="{Binding DefaultReductionAmount}"
                                           FormatString="0"
                                           Minimum="1"
                                           FontSize="14"/>
                        </StackPanel>
                    </Grid>
                </StackPanel>
            </Border>

            <!-- Alert Settings Section -->
            <Border Background="{DynamicResource SemiGrey0Color}"
                    CornerRadius="8"
                    Padding="20">
                <StackPanel Spacing="16">
                    <StackPanel Spacing="6">
                        <TextBlock Text="재고 알림 설정"
                                   FontSize="16"
                                   FontWeight="SemiBold"
                                   Foreground="{DynamicResource SemiGrey8Color}"/>
                        <TextBlock Text="재고 수량에 따른 상태 표시 기준"
                                   FontSize="14"
                                   Foreground="{DynamicResource SemiGrey6Color}"/>
                    </StackPanel>

                    <Grid ColumnDefinitions="*,16,*">
                        <StackPanel Grid.Column="0" Spacing="8">
                            <StackPanel Orientation="Horizontal" Spacing="8">
                                <Border Background="{DynamicResource SemiOrange1Color}"
                                        CornerRadius="3"
                                        Width="10"
                                        Height="10"/>
                                <TextBlock Text="경고 수량" FontSize="15"/>
                            </StackPanel>
                            <NumericUpDown Value="{Binding AlertQuantity}"
                                           FormatString="0"
                                           Minimum="0"
                                           FontSize="14"/>
                        </StackPanel>
                        <StackPanel Grid.Column="2" Spacing="8">
                            <StackPanel Orientation="Horizontal" Spacing="8">
                                <Border Background="{DynamicResource SemiGreen1Color}"
                                        CornerRadius="3"
                                        Width="10"
                                        Height="10"/>
                                <TextBlock Text="안전 수량" FontSize="15"/>
                            </StackPanel>
                            <NumericUpDown Value="{Binding SafeQuantity}"
                                           FormatString="0"
                                           Minimum="0"
                                           FontSize="14"/>
                        </StackPanel>
                    </Grid>
                </StackPanel>
            </Border>

            <!-- Action Buttons -->
            <Grid ColumnDefinitions="*,Auto,Auto" Margin="0,8,0,0">
                <Button Grid.Column="1"
                        Content="취소"
                        Command="{Binding CancelCommand}"
                        Padding="24,12"
                        FontSize="14"
                        Margin="0,0,12,0"/>
                <Button Grid.Column="2"
                        Content="정보 저장"
                        Command="{Binding SaveCommand}"
                        Classes="Primary"
                        Padding="24,12"
                        FontSize="14"/>
            </Grid>
        </StackPanel>
    </ScrollViewer>
</Window>
